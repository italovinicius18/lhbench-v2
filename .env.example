# ============================================================================
# LAKEHOUSE BENCHMARK CONFIGURATION
# ============================================================================

# Benchmark Settings
BENCHMARK_NAME=lakehouse-comparison
BENCHMARK_VERSION=1.0.0
BENCHMARK_ITERATIONS=3

# Frameworks to test (comma-separated: iceberg,delta,hudi)
FRAMEWORKS=iceberg,delta,hudi

# ============================================================================
# TPC-H DATA GENERATION (tpchgen-cli)
# ============================================================================

# Scale Factor (1=1GB, 10=10GB, 100=100GB, 1000=1TB)
TPCH_SCALE_FACTOR=10

# Tables to generate (comma-separated)
TPCH_TABLES=customer,orders,lineitem,supplier,part,partsupp,nation,region

# tpchgen-cli specific settings
TPCHGEN_FORMAT=parquet
TPCHGEN_COMPRESSION=snappy
TPCHGEN_PARTS=4
TPCHGEN_PARQUET_ROW_GROUP_BYTES=134217728

# Generation control
FORCE_REGENERATE=false
BASE_SEED=42

# ============================================================================
# DATA PATHS (Local Filesystem)
# ============================================================================

DATA_ROOT=/data
BRONZE_PATH=/data/bronze/tpch
SILVER_PATH=/data/silver
GOLD_PATH=/data/gold

# Metadata paths
METADATA_PATH=/data/bronze/tpch/_metadata
MANIFEST_PATH=/data/bronze/updates

# ============================================================================
# SPARK CLUSTER CONFIGURATION
# ============================================================================

# Master
SPARK_MASTER_URL=spark://spark-master:7077
SPARK_MASTER_PORT=7077
SPARK_MASTER_UI_PORT=8080

# Workers
SPARK_WORKER_COUNT=2
SPARK_WORKER_CORES=2
SPARK_WORKER_MEMORY=4g

# Driver
SPARK_DRIVER_MEMORY=4g
SPARK_DRIVER_CORES=2
SPARK_DRIVER_MAX_RESULT_SIZE=2g

# Executor
SPARK_EXECUTOR_MEMORY=4g
SPARK_EXECUTOR_CORES=2
SPARK_EXECUTOR_INSTANCES=2

# SQL Optimizations
SPARK_SQL_ADAPTIVE_ENABLED=true
SPARK_SQL_ADAPTIVE_COALESCE_PARTITIONS=true
SPARK_SQL_SHUFFLE_PARTITIONS=200
SPARK_SQL_AUTOBROADCASTJOIN_THRESHOLD=10485760

# Memory Management
SPARK_MEMORY_FRACTION=0.8
SPARK_MEMORY_STORAGE_FRACTION=0.3

# ============================================================================
# APACHE ICEBERG CONFIGURATION
# ============================================================================

ICEBERG_ENABLED=true
ICEBERG_CATALOG_NAME=lakehouse_catalog
ICEBERG_WAREHOUSE_PATH=/data/silver/iceberg
ICEBERG_FILE_FORMAT=parquet
ICEBERG_COMPRESSION=snappy
ICEBERG_TARGET_FILE_SIZE=134217728
ICEBERG_PARQUET_ROW_GROUP_SIZE=134217728

# Iceberg optimizations
ICEBERG_COMMIT_NUM_RETRIES=3
ICEBERG_MERGE_MODE=copy-on-write

# ============================================================================
# DELTA LAKE CONFIGURATION
# ============================================================================

DELTA_ENABLED=true
DELTA_WAREHOUSE_PATH=/data/silver/delta
DELTA_AUTO_OPTIMIZE=true
DELTA_AUTO_COMPACT=true
DELTA_OPTIMIZE_WRITE=true
DELTA_CHECKPOINT_INTERVAL=10

# Delta optimizations
DELTA_MERGE_OPTIMIZATION_ENABLED=true
DELTA_OPTIMIZE_MIN_FILE_SIZE=1073741824

# ============================================================================
# APACHE HUDI CONFIGURATION
# ============================================================================

HUDI_ENABLED=true
HUDI_WAREHOUSE_PATH=/data/silver/hudi
HUDI_TABLE_TYPE=COPY_ON_WRITE
HUDI_CLUSTERING_ENABLED=true
HUDI_INLINE_COMPACT=false

# Hudi optimizations
HUDI_CLEANER_POLICY=KEEP_LATEST_COMMITS
HUDI_CLEANER_COMMITS_RETAINED=3
HUDI_COMPACT_INLINE_MAX_DELTA_COMMITS=5

# ============================================================================
# QUERY EXECUTION SETTINGS
# ============================================================================

# TPC-H queries to run (comma-separated, e.g., "1,3,5" or "all")
TPCH_QUERIES=all

# Query execution
QUERY_TIMEOUT_SECONDS=3600
QUERY_CACHE_ENABLED=false
QUERY_WARMUP_RUNS=1
QUERY_BENCHMARK_RUNS=3

# ============================================================================
# MONITORING & LOGGING
# ============================================================================

LOG_LEVEL=INFO
METRICS_OUTPUT_PATH=/data/gold/metrics
ENABLE_DETAILED_METRICS=true
ENABLE_QUERY_EXPLAIN=true

# Logging format
LOG_FORMAT=json
LOG_TO_FILE=true
LOG_FILE_PATH=/opt/benchmark/results/logs

# ============================================================================
# ADVANCED SETTINGS
# ============================================================================

# Idempotency control
STATE_FILE_PATH=/data/bronze/tpch/_metadata/state.json
ENABLE_STATE_RECOVERY=true

# Performance tuning
PARALLEL_TASKS=4
MAX_CONCURRENT_FRAMEWORKS=3

# Resource limits
MAX_MEMORY_PER_TASK=8g
TIMEOUT_MINUTES=120
